---
import { formFor } from "accel-web";
import { actions } from "../sync/actions";

const { session, params } = Astro.locals;
const { account } = session;
if (Astro.request.method === "POST") {
  if (params.avatar instanceof File) {
    const result = actions.uploadImage(params.avatar, "kydev", "sync-test.png");
    console.log(result);
    Astro.redirect("/profile");
  }
}
const f = formFor(account);
---

<f.Form method="post" enctype="multipart/form-data">
  <input type="file" name="avatar" />
  <f.Submit>Save</f.Submit>
</f.Form>

<h1>Uploaded Image</h1>
<img src="https://kydev.s3.ap-northeast-1.amazonaws.com/sync-test.png" width="200" />
